<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
    xmlns:atom="http://www.w3.org/2005/Atom"
    xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
    xmlns:georss="http://www.georss.org/georss"
    xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#"
    xmlns:media="http://search.yahoo.com/mrss/"
>
    <channel>
        <title>Windowbox</title>
        <atom:link href="{{ base_href }}{{ url_for('get_rss2') }}" rel="self" type="application/rss+xml" />
        <link>{{ base_href }}{{ url_for('get_rss2') }}</link>
        <description>Because moblogs aren't hip anymore.</description>
        <lastBuildDate>{{ items[0].get_created_date_rfc822() }}</lastBuildDate>
        <language>en</language>
        <sy:updatePeriod>hourly</sy:updatePeriod>
        <sy:updateFrequency>1</sy:updateFrequency>
        <generator>Windowbox</generator>
        <copyright>A contrivance by Scott Smitelli. &copy; 2004-{{ copyright_year }}.</copyright>
        <docs>http://backend.userland.com/rss</docs>
        <image>
            <url>{{ base_href }}{{ url_for('static', filename='images/windowbox-dark.png') }}</url>
            <title>Windowbox</title>
            <link>{{ base_href }}{{ url_for('get_index') }}</link>
        </image>

        {% for post in items %}
            {% set attachment = post.get_attachment() %}
            <item>
                <title>{{ post.message }}</title>
                <guid isPermaLink="true">{{ base_href }}{{ url_for('get_post', post_id=post.id) }}</guid>
                <link>{{ base_href }}{{ url_for('get_post', post_id=post.id) }}</link>
                <pubDate>{{ post.get_created_date_rfc822() }}</pubDate>
                <description><![CDATA[
                    <p>
                        <a href="{{ base_href }}{{ url_for('get_post', post_id=post.id) }}">
                            <img src="{{ base_href }}{{ attachment.get_derivative_url(300, 300) }}" alt="{{ post.message }}" border="0" />
                        </a>
                    </p>
                ]]></description>
                <media:thumbnail url="{{ base_href }}{{ attachment.get_derivative_url(300, 300) }}" />
                <media:content url="{{ base_href }}{{ attachment.get_derivative_url(300, 300) }}" medium="image">
                    <media:title type="html">{{ post.message }}</media:title>
                </media:content>
                <!-- TODO geo? -->
            </item>
        {% endfor %}
    </channel>
</rss>
